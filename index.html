<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>xlU_go</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" type="text/css" href="css/main.css" />
  <link rel="stylesheet" type="text/css" href="css/normalize.css" />
  <link rel="stylesheet" type="text/css" href="css/ghp.css" />
</head>
<body>
<div class="content">
<h1 class="libTop">xlU_go</h1>

<p>Content-keyed directory structures for
<a href="https://jddixon.github.io/xlattice_go">xlattice_go;</a>
a Go implementation of a file system
based on <strong>content keys</strong>, where a content key is a cryptographically
secure hash.</p>

<p>either 20 or 32 bytes long.</p>

<h2>Directory Structure</h2>

<p>Files are stored under two directory levels.
At the upper level, directory names are the hex value of the first
8 bits of the content key, so there are 256 such directories.
Below each is a set of directories whose names correspond to the
second byte of the content key.  Files within the lower directories
have names based on the hex value of the rest of the content key.
Conventionally the upper directory is called <code>U</code>.</p>

<p>So if a file has a content key like <code>0xabcdef01234...</code> then it will
usually be found at <code>U/ab/cd/ef01234...</code></p>

<p>There will also be at least two subdirectories at the upper level</p>

<ul>
<li><code>U/in</code>, used for assembling files prior to being moved into the
appropriate lower directory; typically used for files being
received over the wire</li>
<li><code>U/tmp</code>, similarly used by the system for temporary storage of files
being moved into <code>U/</code> from the local file system</li>
</ul>

<h2>Content Keys</h2>

<p>Hashes are calculated using
a variant of the
<a href="https://en.wikipedia.org/wiki/Secure_Hash_Algorithm">Secure Hash Algorithm</a>.
Currently three versions of SHA are supported:</p>

<ul>
<li><strong>SHA1</strong> (20 bytes/160 bits), also called SHA-1</li>
<li><strong>SHA2</strong> (32 bytes/256 bits), also called SHA-256</li>
<li><strong>SHA3</strong> (32 bytes/256 bits), which is the 256-bit variant of <strong>Keccak</strong>,
the winner of a recent competition run by an agency of the US government</li>
</ul>

<h2>API</h2>

<pre><code>CopyAndPut(path string, key []byte) (int64, error)
CopyAndPut1(path, key string) (int64, string, error)
CopyAndPut2(path, key string) (int64, string, error)
CopyAndPut3(path, key string) (int64, string, error)

GetData(key []byte) ([]byte, error)
GetData1(key string) (data []byte, err error)
GetData2(key string) (data []byte, err error)
GetData3(key string) (data []byte, err error)

Put(inFile string, key []byte) (length int64, err error)
Put1(inFile, key string) (length int64, hash string, err error)
Put2(inFile, key string) (length int64, hash string, err error)
Put3(inFile, key string) (length int64, hash string, err error)

PutData(data []byte, key []byte) (length int64, hash []byte, err error)
PutData1(data []byte, key string) (length int64, hash string, err error)
PutData2(data []byte, key string) (length int64, hash string, err error)
PutData3(data []byte, key string) (length int64, hash string, err error)

GetDirStruc() DirStruc
GetPath() string 

// These exist in two forms, for convenience
HexKeyExists(key string) (bool, error)
ByteKeyExists(key []byte) (bool, error)

HexKeyFileLen(key string) (length int64, err error)
ByteKeyFileLen(key []byte) (length int64, err error)

GetPathForHexKey(key string) (string, error)
GetPathForByteKey(key []byte) (string, error)
</code></pre>

<h2>Implementation</h2>

<p>The actual Go code is in <code>u.go</code>.  Test code is in three files:
<code>hash_test.go</code> contains common tests, and <code>sha1_test.go</code> and
<code>sha3_test.go</code> contain driver code specifc to SHA1 and SHA3 respectively.</p>

<p><code>myData</code>, <code>myU1</code>, <code>myU2</code>, and <code>myU3</code> are scratch directories used in testing.
The file named <code>abc</code> contains just that string and is used in an
extremely simple check that SHA3 is functionng correctly.
The Keccak distribution (<code>KeccakKat-3.zip</code>) contains a very large collection
of test vectors.</p>

<h2>Project Status</h2>

<p>The code is stable and well-tested.</p>

<h2>Licensing</h2>
<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />The material on this github.io website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
<p>Project software is licensed under an MIT license.
Follow the SOFTWARE LICENSE link below for more information on project software licensing.</p>  <div class="f">
    <hr />
    <div class="license">
      <p><a href="LICENSE.html">SOFTWARE LICENSE</a></p>
    </div>
    <div class="project">
      github <a href="https://github.com/jddixon/xlU_go">      <img src="img/GitHub-Mark-32px.png" 
        alt="link to project"  
        style="display: inline-block; margin-left: 0 auto; margin-right: 0 auto">
       </a> project
    </div>
    <div class="logo" >
      <a href="http://www.xlattice.org">
      <img src="img/xlattice-2014.jpg" alt="the XLattice Project" style="float: right;" >
      </a>
    </div>
  </div>
</div>
</body>
</html>
