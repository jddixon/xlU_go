xlattice_go/reg/TODO

2013-10-02
    CLIENT, MOCK_CLIENT
    * mock_client renamed client_node.go
    * MockClient becomes ClientNode
    * client.go reorganized a bit so that it either loads or
        creates a ClientNode
    
    * change protocol so that nodeID is assigned by server (to
        avoid Douceur's Sybil Attack)
        - so first variant of Client message has token + digSig
            * without clientID in token
                - any client ID is ignored and discarded
                - which will cause digSig to be wrong
        - second version of Client message has only clientID + digSig
        - either attaches client's full token to the connection
            * this includes nodeID
    * move Node into Client struct 
    * code up the usual serialization/deserialization 
        * ParseClient
        * Client.String()
        * Client.Strings()
        * Client.Run()
    * when a Client is run, 
        - if it has a configuration in its lfs, it loads = does a 
            ParseClient on its configuration file; this returns
            a Client with a *xn.Node field
        - otherwise it starts talking to the server (does a 
            Hello/Reply to get a session key) and then sends a
            Client message without a nodeID; the nodeID returned
            is used to build its *xn.Node
    * if testing (-T option), default lfs is ./tmp/ID/lfs, where
        ID is the hex version of the server-assigned ID
    * otherwise default lfs is ./lfs
        - so there is one obvious configuration file in a subdirectory
            of the current directory
    
    SERVER, CLIENT/SERVER MESSAGING
    * it must be possible for a Client to create a Cluster (by name)
        and set its size without joining it
        - ah: it must be possible for a Client to create a Cluster
            without a name and get its assigned name and ID back
    * equally it must be possible for a client to join a cluster 
        using its name and get its ID back
        - but if its full the client gets a ClusterFull error msg

    * rename Get msg to GetCluster, Members to ClusterMembers           * DONE
    * code up RegNode serialization in reg/reg_node.go:				    * DONE
        - ParseRegNode()							                    * DONE
        - String()						                            	* DONE
        - Strings()							                            * DONE

    * code up Registry serialization in reg/registry.go:
        - ParseRegistry()
        - String()
        - Strings()

    * code up RegServer bits in reg/server.go:
        - Run()                                                         * DONE
        - ParseRegServer()
        - String()
        - Strings()

    * any errors found by InHandler should be logged

2013-10-01
    * InHandler.Run() needs range check on op or tag about line 169     * DONE
    * need locking for reg_cluster Members 
        - checking whether client is cluster member by name (read lock) * DONE
        - adding member to cluster by name (write lock)                 * DONE
        - checking whether client is cluster member by ID (read lock)
        - adding member to cluster by ID (write lock)                   * DONE
    * registry RegMembersByID should be dropped or used; if used
        - when members added to clusters
            * must read lock reg and check reg.RegMembersByID
            * must write lock when adding
        - but need to decide whether this is useful
            * and whether the intention is to prevent clients from
                belonging to more than one cluster (why??)
    * move relevant bits of MockServer into reg/server.go               * DONE
        - implement reg.Server.NewServer(...)                           * DONE
        - and reg.Server.Run(...)                                       * DONE
    * when this is running, drop into ../cmd/xlReg/xlReg

2013-09-30
    * xlReg loads from/saves to lfs (see 09-16 TODO)
    * xlReg 0.2.0 must have lfs, logging, load/save
    * deploy xlReg 0.2.0 on salinas:55555
2013-09-29
    * improve RegCluster.AddMember handling of dupe names
2013-09-24
    * packets.go readData should handle partial reads, looping on count 
        until all bytes have been received
    * packets.go writeData should handle partial writes, looping on count 
        until all bytes have gone
2013-09-20
    * several tests could obviously benefit from parallelizing: 
        they run one CPU at 100% while the others are more or less idle
        - look at cluster_member_test
        - also reg_cluster_test 
2013-09-16
    * regNode serialization follows practice in ../node: we first
        serialize BaseNode, then rest of Node, then fields of 
        RegNode
        - need Strings(), String(), Parse()
2013-09-13
    * URGENT FIX: ClientMsg does NOT include digsig, so server cannot 
        verify that the client knows skPriv
    * longer term xlReg needs to be distributed, using Paxos for
        consensus
2013-09-12
    * build and thoroughly test ../cmd/xlReg
    * this stays on main branch
    * deploy on test:44444 as service

    * on regBeta branch figure out how to persist the registry in 
        such a way this it easily loads itself from disk after a 
        crash or reboot
    * when this is stable, merge back into main branch
        - and deploy on test:44444
    * document
